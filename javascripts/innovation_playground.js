$(function(){$.fn.imagesLoaded=function(i){function e(){i.call(a,n)}function t(){0>=--r&&this.src!==o&&(setTimeout(e),n.off("load error",t))}var n=this.find("img"),r=n.length,a=this,o="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";return r||e(),n.on("load error",t).each(function(){if(this.complete||void 0===this.complete){var i=this.src;this.src=o,this.src=i}}),this};var i=$("#rg-items"),e=i.find("div.es-carousel-wrapper"),t=e.find("ul > li"),n=t.length;AllItems=function(){var r=0,a="carousel",o=!1,l=function(){t.add('<img src="../images/innovation/ajax-loader.gif"/><img src="../images/innovation/black.png"/>').imagesLoaded(function(){d(),f(t.eq(r))}),"carousel"===a&&s()},s=function(){e.show().elastislide({imageW:276,onClick:function(i){return o?!1:(o=!0,f(i),r=i.index(),void 0)}}),e.elastislide("setCurrent",r)},d=function(){if($("#img-wrapper-tmpl").tmpl({itemsCount:n}).appendTo(i),n>1){var e=i.find("a.rg-image-nav-prev"),t=i.find("a.rg-image-nav-next"),r=i.find("div.rg-container");e.on("click.itemContainer",function(){return c("left"),!1}),t.on("click.itemContainer",function(){return c("right"),!1}),r.touchwipe({wipeLeft:function(){c("right")},wipeRight:function(){c("left")},preventDefaultEvents:!1}),$(document).on("keyup.itemContainer",function(i){39==i.keyCode?c("right"):37==i.keyCode&&c("left")})}},c=function(i){return o?!1:(o=!0,"right"===i?r+1>=n?r=0:++r:"left"===i&&(0>r-1?r=n-1:--r),f(t.eq(r)),void 0)},f=function(n){var l=i.find("div.rg-loading").show();t.removeClass("selected"),n.addClass("selected");var s=n.find("img"),d=s.data("large"),c=n.find("div.story_text"),f=s.parents("li");$("<img>").load(function(){i.find("div.rg-image").children("div.story_img").html('<img src="'+d+'"/>'),i.find("div.rg-text").html(c),f.append(c.clone()),l.hide(),"carousel"===a&&(e.elastislide("reload"),e.elastislide("setCurrent",r)),o=!1}).attr("src",d)},u=function(){};return{init:l,addAllItems:u}}(),AllItems.init()});